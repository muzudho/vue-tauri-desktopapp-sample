<template>
</template>

<script setup lang="ts">

    // ##############
    // # ã‚¤ãƒ³ãƒãƒ¼ãƒˆ #
    // ##############

    import { computed } from 'vue';
    // ğŸ‘† ï¼»åˆç´šè€…å‘ã‘ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼½ã§ã¯ã€ reactive ã¯ä½¿ã„ã¾ã›ã‚“ã€‚

    // ++++++++++++++++++
    // + ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ« +
    // ++++++++++++++++++

    // import type { PrintingInput, PrintingMotion } from '../composables/player-controller';

    // ++++++++++++++++++++++++++++++++++++
    // + ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€€ï¼ã€€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ +
    // ++++++++++++++++++++++++++++++++++++

    import type Rectangle from '../interfaces/Rectangle';


    // ####################################
    // # ã“ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå—ã‘å–ã‚‹å¼•æ•° #
    // ####################################
    
    interface Props {

        // ++++++++++++++++++++++++++
        // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€ç›¤ï¼‘ +
        // ++++++++++++++++++++++++++

        // tileBoard1TileWidth: number,
        // tileBoard1TileHeight: number,
        // board1FileNum: number,  // ç­‹ã®æ•°ã€‚ãŸã ã—ã€å³å´ã¨ä¸‹å´ã«ï¼‘ãƒã‚¹ä½™åˆ†ã«ä»˜ã„ã¦ã„ã‚‹ãƒã‚¹ã‚¯ã¯å«ã¾ãªã„ã€‚
        // board1FloorTilemapTileNum: number,  // åºŠã®ã‚¿ã‚¤ãƒ«ãƒãƒƒãƒ—ã®ã€å·¦ä¸Šéš…ã‹ã‚‰æ•°ãˆãŸã‚¿ã‚¤ãƒ«æ•°

        // ++++++++++++++++++++++++++++
        // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€å°å­—ï¼‘ +
        // ++++++++++++++++++++++++++++

        // printing1FileMax: number,
        // printing1RankMax: number,
        // printing1FileNum: number,
        // printing1RankNum: number,
        // printing1Left: number,
        // printing1Top: number,
        // printing1Input: PrintingInput,
        // printing1Motion: PrintingMotion,
        // printing1MotionSpeed: number,
        // printing1MotionWait: number,
        // printing1MotionWalkingFrames: number,
        sourceTilemapRectangles: Rectangle[],
        // printing1OutOfSightIsLock: boolean,
        // printing1IsLooping: boolean,
        imageBoard1Data: number[],

    }
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®š
    const props = defineProps<Props>();
    // åŒæ–¹å‘ã«å¤‰æ›´é€šçŸ¥ãŒé£›ã¶ã‚ˆã† v-model åŒ–ï¼š
    defineEmits<{

        // ++++++++++++++++++++++++++
        // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€ç›¤ï¼‘ +
        // ++++++++++++++++++++++++++

        // 'update:board1FileNum': [value: number];

        // ++++++++++++++++++++++++++++
        // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€å°å­—ï¼‘ +
        // ++++++++++++++++++++++++++++

        // 'update:printing1FileNum': [value: number];
        // 'update:printing1RankNum': [value: number];
        // 'update:printing1Left': [value: number];
        // 'update:printing1Top': [value: number];
        // 'update:printing1Input': [value: PrintingInput];
        // 'update:printing1Motion': [value: PrintingMotion];
        // 'update:printing1MotionSpeed': [value: number];
        // 'update:printing1MotionWait': [value: number];
        // 'update:printing1MotionWalkingFrames': [value: number];
        'update:sourceTilemapRectangles': [value: Rectangle[]];
        // 'update:printing1OutOfSightIsLock': [value: boolean];
        // 'update:printing1IsLooping': [value: boolean];
        'update:imageBoard1Data': [value: number[]];
    }>();

    // ################
    // # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #
    // ################

    // ++++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€å°å­— +
    // ++++++++++++++++++++++++**
    //
    // ç›¤ä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹æ•°å­—æŸ„ã€çµµæŸ„ãªã©ã€‚
    //

    /**
     * ãƒã‚¹ã®å°å­—ã€‚ã‚½ãƒ¼ã‚¹ãƒ»ã‚¿ã‚¤ãƒ«ãƒãƒƒãƒ—ã®ã‚¿ã‚¤ãƒ«ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ x ã®æ–‡å­—åˆ—ã€‚
     * @returns è©²å½“ãªã—ã®ã¨ã "-"
     */
    const getSourceTileSqStringByImageBoardSq = computed<
        (printingIndex: number) => string
    >(() => {
        return (printingIndex: number) => {

            if (printingIndex == -1) {
                return "-"; // å°å­—ã®ã‚µã‚¤ã‚ºã®ç¯„å›²å¤–ã«ãªã‚‹ã¨ã“ã‚ã«ã¯ã€"-" ã§ã‚‚è¡¨ç¤ºã—ã¦ãŠã
            }

            const sourceTileIndex = props.imageBoard1Data[printingIndex];
            return `${sourceTileIndex}`;
        };
    });


    /**
     * å°å­—è¡¨ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ¸¡ã™ã“ã¨ã§ã€ãã“ã«å°å­—ã™ã‚‹ã‚¿ã‚¤ãƒ«ã®ã€ã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ«ã® left ã‚’è¿”ã™ã€‚
     */
    const getSourceTileLeftByImageSq = computed<
        (printingIndex:number) => number
    >(() => {
        return (printingIndex: number) => {

            if (printingIndex == -1) {
                return 0;   // å°å­—ã®ã‚µã‚¤ã‚ºã®ç¯„å›²å¤–ã«ãªã‚‹ã¨ã“ã‚ã«ã¯ã€ã¨ã‚Šã‚ãˆãš 0 ã‚’è¿”ã™ã€‚å·¦ä¸Šã®ã‚¿ã‚¤ãƒ«ãŒé¸ã°ã‚Œã‚‹ã€‚
            }

            const sourceTileIndex = props.imageBoard1Data[printingIndex];

            try {
                return props.sourceTilemapRectangles[sourceTileIndex]["left"];
            } catch(error) {
                console.error(`ERROR: ${error} | printingIndex=${printingIndex}`);
                return 0;
            }
        };
    });


    // ################
    // # ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚º #
    // ################

    defineExpose({
        getSourceTileSqStringByImageBoardSq,
        getSourceTileLeftByImageSq,
    });

</script>

<style scoped>
</style>
