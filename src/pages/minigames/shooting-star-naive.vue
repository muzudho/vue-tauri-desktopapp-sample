<template>
    <the-header/>

    <!-- ãƒœã‚¿ãƒ³æ©Ÿèƒ½æ‹¡å¼µ -->
    <button-20250822 ref="button1Ref"/>

    <h3>ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ»ã‚¹ã‚¿ãƒ¼ï¼ˆåˆç´šè€…å‘ã‘ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼‰</h3>
    <section class="sec-3">

        <!-- ã‚²ãƒ¼ãƒ ã®æ“ä½œæ–¹æ³• -->
        <v-btn @click="appManualIsShowing = !appManualIsShowing">{{ appManualIsShowing ? 'ã‚²ãƒ¼ãƒ ã®éŠã³æ–¹é–‰ã˜ã‚‹' : 'ã‚²ãƒ¼ãƒ ã®éŠã³æ–¹ã‚’è¡¨ç¤º' }}</v-btn>
        <section class="sec-1" v-if="appManualIsShowing">
            <br>
            <p>
                ã“ã®ã‚²ãƒ¼ãƒ ã¯ã€æ˜Ÿã‚’æ’®å½±ã™ã‚‹ã€ã¨ã„ã†çŠ¶æ³ã‚’è¦‹ç«‹ã¦ãŸã‚²ãƒ¼ãƒ ã ãœã€‚<br/>
                <br/>
                ä¸‹ã«é»’ã„ç”»é¢ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’åºƒã’ã¦ãã‚Œã ãœã€‚<br/>
                ã“ã®é»’ã„ç”»é¢ã¯å®‡å®™ãªã€‚<br/>
                ï¼»ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆï¼½ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ã‚²ãƒ¼ãƒ ãŒå§‹ã¾ã‚‹ãœã€‚<br/>
                ãŸã¾ã«æ˜ŸãŒæµã‚Œã¦ãã‚‹ã€‚<br/>
                60ç§’ã®é–“ã«ã€ã‚«ãƒ¡ãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ã‚’ä¸Šä¸‹å·¦å³ã«å‹•ã‹ã—ã¦ã€æ˜Ÿã‚’ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ã®ä¸­ã«å…¥ã£ã¦ã„ã‚‹ã¨ãã«ã€ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã‚Œã ãœã€‚ã“ã‚Œã§ 100ç‚¹ ã ãœã€‚<br/>
                <br/>
                é£½ããŸã‚‰çµ‚ã‚ã‚Šã ãœã€‚<br/>
            </p>
        </section><br/>
        <br/>
        <p>ãƒœã‚¿ãƒ³</p>
        <ul>
            <li>
                <!-- ãƒœã‚¿ãƒ³ã‚’ä¸¦ã¹ã‚‹ -->
                <v-btn
                    class="code-key"
                    @touchstart.prevent="button1Ref?.press($event, onGameStartOrEndButtonPushed, {repeat: true});"
                    @touchend="button1Ref?.release();"
                    @touchcancel="button1Ref?.release();"
                    @touchleave="button1Ref?.release();"
                    @mousedown.prevent="button1Ref?.handleMouseDown($event, onGameStartOrEndButtonPushed, {repeat: true})"
                    @mouseup="button1Ref?.release();"
                    @mouseleave="button1Ref?.release();"
                >{{ appGameIsPlaying ? "ã‚²ãƒ¼ãƒ çµ‚äº†" : "ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ" }}</v-btn>
                <v-btn
                    class="code-key"
                    @touchstart.prevent="button1Ref?.press($event, onGamePauseOrRestartButtonPushed, {repeat: true});"
                    @touchend="button1Ref?.release();"
                    @touchcancel="button1Ref?.release();"
                    @touchleave="button1Ref?.release();"
                    @mousedown.prevent="button1Ref?.handleMouseDown($event, onGamePauseOrRestartButtonPushed, {repeat: true})"
                    @mouseup="button1Ref?.release();"
                    @mouseleave="button1Ref?.release();"
                >{{ appGameIsPause ? "å†é–‹" : "ä¸€æ™‚åœæ­¢" }}</v-btn>

                <!-- ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å¤–ã™ãŸã‚ã®ãƒ€ãƒŸãƒ¼ãƒ»ãƒœã‚¿ãƒ³ã§ã™ -->
                <v-btn
                    class="noop-key"
                    ref="noopButton"
                    v-tooltip="'PCã§ã®ãƒã‚¦ã‚¹æ“ä½œã§ã€ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã«æ®‹ã£ã¦é‚ªé­”ã«ãªã‚‹ã¨ãã¯ã€ã“ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã‚Œã ãœ'"
                >ä½•ã‚‚ã—ãªã„ãƒœã‚¿ãƒ³</v-btn>
            </li>
        </ul>
        <br/>
        <p>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œæ–¹æ³•</p>
        <ul>
            <li>ï¼°ï¼£ãªã‚‰ãƒœã‚¿ãƒ³ã‚’ãƒã‚¦ã‚¹ã‚¯ãƒªãƒƒã‚¯ã‹ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã€ã‚¹ãƒãƒ›ãªã‚‰ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒã€‚</li>
            <li>
                <v-btn class="code-key hidden"/>
                <v-btn
                    class="code-key"
                    @touchstart.prevent="button1Ref?.press($event, onUpButtonPressed, {repeat: true});"
                    @touchend="button1Ref?.release(onUpButtonReleased);"
                    @touchcancel="button1Ref?.release(onUpButtonReleased);"
                    @touchleave="button1Ref?.release(onUpButtonReleased);"
                    @mousedown.prevent="button1Ref?.handleMouseDown($event, onUpButtonPressed, {repeat: true})"
                    @mouseup="button1Ref?.release(onUpButtonReleased);"
                    @mouseleave="button1Ref?.release(onUpButtonReleased);"
                >â†‘</v-btn>
                <br/>
                <v-btn
                    class="code-key"
                    @touchstart.prevent="button1Ref?.press($event, onLeftButtonPressed, {repeat: true});"
                    @touchend="button1Ref?.release(onLeftButtonReleased);"
                    @touchcancel="button1Ref?.release(onLeftButtonReleased);"
                    @touchleave="button1Ref?.release(onLeftButtonReleased);"
                    @mousedown.prevent="button1Ref?.handleMouseDown($event, onLeftButtonPressed, {repeat: true})"
                    @mouseup="button1Ref?.release(onLeftButtonReleased);"
                    @mouseleave="button1Ref?.release(onLeftButtonReleased);"
                >â†</v-btn>
                <v-btn class="code-key hidden"/>
                <v-btn
                    class="code-key"
                    @touchstart.prevent="button1Ref?.press($event, onRightButtonPressed, {repeat: true});"
                    @touchend="button1Ref?.release(onRightButtonReleased);"
                    @touchcancel="button1Ref?.release(onRightButtonReleased);"
                    @touchleave="button1Ref?.release(onRightButtonReleased);"
                    @mousedown.prevent="button1Ref?.handleMouseDown($event, onRightButtonPressed, {repeat: true})"
                    @mouseup="button1Ref?.release(onRightButtonReleased);"
                    @mouseleave="button1Ref?.release(onRightButtonReleased);"
                >â†’</v-btn>
                ã€€â€¦ã€€ã‚«ãƒ¡ãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ï¼ˆç‚¹ç·šã®é•·æ–¹å½¢ã ï¼‰ã‚’ä¸Šä¸‹å·¦å³ã«ç§»å‹•
                <br/>
                <v-btn class="code-key hidden"/>
                <v-btn
                    class="code-key"
                    @touchstart.prevent="button1Ref?.press($event, onDownButtonPressed, {repeat: true});"
                    @touchend="button1Ref?.release(onDownButtonReleased);"
                    @touchcancel="button1Ref?.release(onDownButtonReleased);"
                    @touchleave="button1Ref?.release(onDownButtonReleased);"
                    @mousedown.prevent="button1Ref?.handleMouseDown($event, onDownButtonPressed, {repeat: true})"
                    @mouseup="button1Ref?.release(onDownButtonReleased);"
                    @mouseleave="button1Ref?.release(onDownButtonReleased);"
                >â†“</v-btn>
                <br/>
            </li>
            <li>
                <v-btn
                    class="code-key"
                    @touchstart.prevent="button1Ref?.press($event, onEnterButtonPressed, {repeat: true});"
                    @touchend="button1Ref?.release(onEnterButtonReleased);"
                    @touchcancel="button1Ref?.release(onEnterButtonReleased);"
                    @touchleave="button1Ref?.release(onEnterButtonReleased);"
                    @mousedown.prevent="button1Ref?.handleMouseDown($event, onEnterButtonPressed, {repeat: true})"
                    @mouseup="button1Ref?.release(onEnterButtonReleased);"
                    @mouseleave="button1Ref?.release(onEnterButtonReleased);"
                >ï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ï¼‰</v-btn>
                ã€€â€¦ã€€æ’®å½±ã€‚
            </li>
        </ul>
        <br/>
        <div>
            <p style="font-size: x-large; margin-top: 8px; margin-bottom: 8px;">
            ã‚¹ã‚³ã‚¢ï¼š {{ appGameScore }}ã€€ã€€æ®‹ã‚Šæ™‚é–“: {{ Math.floor((appGameMaxCount - stopwatch1Count) / commonSeconds) }} . {{ (appGameMaxCount - stopwatch1Count) % commonSeconds }}
            </p>
        </div>

        <!-- ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã€‚ãƒ‡ãƒãƒƒã‚°ã«ä½¿ã„ãŸã„ã¨ãã¯ã€ display: none; ã‚’æ¶ˆã—ã¦ãã ã•ã„ã€‚ -->
        <stopwatch
            ref="stopwatch1Ref"
            v-on:countUp="(countNum) => { stopwatch1Count = countNum; }"
            style="display: none;" />

        <!-- ã‚²ãƒ¼ãƒ ç”»é¢é ˜åŸŸï¼ˆå®‡å®™ï¼‰ -->
        <div style="position:relative; left: 0; top: 0; width:512px; height:384px; background-color: #303030;">
            <!--
                ã‚°ãƒªãƒƒãƒ‰
                NOTE: ãƒ«ãƒ¼ãƒ—ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã¯ 1 ã‹ã‚‰å§‹ã¾ã‚‹ã®ã§ã€1ï½9ã®9å€‹ã®ã‚»ãƒ«ã‚’ä½œæˆã€‚
            -->
            <div v-for="i in board1Area" :key="i"
                :style="`position:absolute; top: ${Math.floor((i - 1) / board1Files) * board1SquareHeight}px; left: ${((i - 1) % board1Files) * board1SquareWidth}px; width:${board1SquareWidth}px; height:${board1SquareHeight}px; border: solid 1px gray;`"></div>

            <!-- æ˜Ÿ -->
            <Tile
                :srcLeft="0"
                :srcTop="0"
                :srcWidth="board1SquareWidth"
                :srcHeight="board1SquareHeight"
                tilemapUrl="/img/making/sprite-objects-001.png"
                :style="starStyle"
                style="position:absolute;" /><br/>

            <!-- ã‚«ãƒ¡ãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ï¼ˆç‚¹ç·šã®æ ï¼‰ -->
            <div
                class="player"
                :style="playerStyle"
                style="position:absolute;" ></div>

            <!-- ãƒªãƒ­ãƒ¼ãƒ‰ã®ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ï¼ˆãƒ‘ã‚¤ã¿ãŸã„ãªã‚„ã¤ï¼‰ -->
            <Tile
                :srcLeft="reloadPie1TileLeft"
                :srcTop="reloadPie1TileTop"
                :srcWidth="board1SquareWidth"
                :srcHeight="board1SquareHeight"
                tilemapUrl="/img/making/202508__warabenture__16-2357-8counts-red.png"
                :style="reloadPieStyle"
                style="position:absolute;" /><br/>
                
        </div>

        <!-- ãƒ‡ãƒãƒƒã‚°ç”¨ -->
        <!--
            <p>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»ã‚¹ãƒ†ãƒƒãƒ—: {{ appGameScheduleStep.value }}</p>
            <p>æ˜Ÿã€€è¡Œï¼š {{ star1Ranks }}</p>
            <p>æ˜Ÿã€€åˆ—ï¼š {{ star1Files }}</p>
            <p>ãƒªãƒ­ãƒ¼ãƒ‰ãƒ»ã‚¿ã‚¤ãƒ : {{ player1ReloadTime.value }}</p>
            <br/>
            <p>å…ƒç”»åƒã®ã‚¿ã‚¤ãƒ«ãƒãƒƒãƒ—ã‚’è¡¨ç¤ºï¼š</p>
            <v-img src="/img/making/sprite-objects-001.png" style="width:128px; height:128px; border: dashed 4px gray;"/><br/>
            <v-img src="/img/making/202508__warabenture__16-2357-8counts-red.png" style="width:128px; height:64px; border: dashed 4px gray;"/><br/>
            ï¼šã“ã“ã¾ã§ã€‚
        -->
    </section>
    
    <br/>
    <h3>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</h3>
    <section class="sec-3">
        <source-link/>
    </section>

    <the-footer/>
</template>

<script setup lang="ts">

    console.log("ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¹ã‚¿ãƒ¼ã€€ï¼ˆåˆç´šè€…å‘ã‘ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç‰ˆï¼‰")

    // ##############
    // # ã‚¤ãƒ³ãƒãƒ¼ãƒˆ #
    // ##############

    import { computed, onMounted, onUnmounted, ref, watch } from 'vue';
    // ğŸ‘† ï¼»åˆç´šè€…å‘ã‘ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼½ã§ã¯ã€ reactive ã¯ä½¿ã„ã¾ã›ã‚“ã€‚

    import { VBtn } from 'vuetify/components';

    // ++++++++++++++++++++++++++++++++++
    // + ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€€ï¼ã€€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ +
    // ++++++++++++++++++++++++++++++++++

    // from ã®éšå±¤ãŒä¸Šã®é †ã€ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †
    import Button20250822 from '../../components/Button20250822.vue';
    import SourceLink from '../../components/SourceLink.vue';
    import Stopwatch from '../../components/Stopwatch.vue';
    import Tile from '../../components/Tile.vue';
    import TheFooter from './the-footer.vue';
    import TheHeader from './the-header.vue';


    // ##########
    // # ã‚³ãƒ¢ãƒ³ #
    // ##########
    //
    // ã‚ˆãä½¿ã†è¨­å®šã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã€‚ç‰¹ã«ä¸å¤‰ã®ã‚‚ã®ã€‚
    //

    const commonSeconds = 60; // 1ç§’ã¯60ãƒ•ãƒ¬ãƒ¼ãƒ 
    const commonSpriteMotionLeft = -1;  // ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆmotionï¼‰å®šæ•°ã€‚ã‚«ãƒ¡ãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ãŒå·¦ã«ç§»å‹•ã™ã‚‹
    const commonSpriteMotionRight = 1;
    const commonSpriteMotionUp = -1;
    const commonSpriteMotionDown = 1;


    // ############################
    // # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ãƒ‡ãƒ¼ã‚¿ #
    // ############################
    //
    // ä»Šå‹•ã„ã¦ã„ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã‚’è¨˜éŒ²ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã€‚ç‰¹ã«å¯å¤‰ã®ã‚‚ã®ã€‚
    //

    const appManualIsShowing = ref<boolean>(false);     // ã‚²ãƒ¼ãƒ ã®æ“ä½œæ–¹æ³•ãƒ»éŠã³æ–¹èª¬æ˜æ›¸ã‚’è¡¨ç¤ºä¸­
    const appGameScore = ref<number>(0);                // å¾—ç‚¹
    const appGameIsPlaying = ref<boolean>(false);       // ã‚²ãƒ¼ãƒ ä¸­
    const appGameIsPause = ref<boolean>(false);         // ã‚²ãƒ¼ãƒ ã¯ä¸€æ™‚åœæ­¢ä¸­
    const appGameMaxCount = computed(()=>60 * commonSeconds);   // ã‚²ãƒ¼ãƒ æ™‚é–“ã¯ï¼‘åˆ†
    const appGameScheduleStep = ref<number>(0);         // æ˜Ÿã®å‡ºç¾ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«


    // ################
    // # èª­è¾¼ãƒªã‚½ãƒ¼ã‚¹ #
    // ################

    // ++++++++++++++++++++++++++++
    // + èª­è¾¼ãƒªã‚½ãƒ¼ã‚¹ã€€ï¼ã€€åŠ¹æœéŸ³ +
    // ++++++++++++++++++++++++++++

    const sfxConfigVolume = 0.3;                        // éŸ³é‡

    let sfxDeniedAudio: HTMLAudioElement;               // æ‹’å¦éŸ³
    let sfxDeniedIsPlaying: boolean = false;            // æ‹’å¦éŸ³ã®å†ç”ŸçŠ¶æ…‹
    let sfxCameraShutterAudio: HTMLAudioElement;        // ã‚«ãƒ¡ãƒ©ã§æ’®å½±ã—ãŸã¨ãã®åŠ¹æœéŸ³
    let sfxCameraShutterIsPlaying: boolean = false;     //
    let sfxMissAudio: HTMLAudioElement;                 // ãƒŸã‚¹éŸ³
    let sfxMissIsPlaying: boolean = false;              //

    /**
     * åŠ¹æœéŸ³ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ï¼ˆjsfxrã§ä½œã£ãŸåŠ¹æœéŸ³ï¼‰
     */
    function sfxLoad() : void {
        sfxDeniedAudio = new Audio('/wav/202508__sfx__17-0200-denied.wav'); // æ‹’å¦éŸ³
        sfxDeniedAudio.volume = sfxConfigVolume;
        sfxDeniedAudio.addEventListener('play', () => { sfxDeniedIsPlaying = true })
        sfxDeniedAudio.addEventListener('pause', () => { sfxDeniedIsPlaying = false })
        sfxDeniedAudio.addEventListener('ended', () => { sfxDeniedIsPlaying = false })

        sfxCameraShutterAudio = new Audio('/wav/202508__sfx__16-2117-cameraShutter.wav'); // ã‚«ãƒ¡ãƒ©ã®ã‚·ãƒ£ãƒƒã‚¿ãƒ¼éŸ³
        sfxCameraShutterAudio.volume = sfxConfigVolume;
        sfxCameraShutterAudio.addEventListener('play', () => { sfxCameraShutterIsPlaying = true })
        sfxCameraShutterAudio.addEventListener('pause', () => { sfxCameraShutterIsPlaying = false })
        sfxCameraShutterAudio.addEventListener('ended', () => { sfxCameraShutterIsPlaying = false })

        sfxMissAudio = new Audio('/wav/202508__sfx__16-2146-miss.wav'); // ãƒŸã‚¹éŸ³
        sfxMissAudio.volume = sfxConfigVolume;
        sfxMissAudio.addEventListener('play', () => { sfxMissIsPlaying = true })
        sfxMissAudio.addEventListener('pause', () => { sfxMissIsPlaying = false })
        sfxMissAudio.addEventListener('ended', () => { sfxMissIsPlaying = false })
    }


    // ################
    // # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #
    // ################

    // ++++++++++++++++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€ä½•ã‚‚ã—ãªã„ãƒœã‚¿ãƒ³ +
    // ++++++++++++++++++++++++++++++++++++++

    const noopButton = ref<InstanceType<typeof VBtn> | null>(null);

    // ++++++++++++++++++++++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€ãƒœã‚¿ãƒ³æŠ¼ã—ã£ã±ãªã—æ©Ÿèƒ½ +
    // ++++++++++++++++++++++++++++++++++++++++++++

    const button1Ref = ref<InstanceType<typeof Button20250822> | null>(null);

    // ++++++++++++++++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒ +
    // ++++++++++++++++++++++++++++++++++++++

    const stopwatch1Ref = ref<InstanceType<typeof Stopwatch> | null>(null); // Stopwatch ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
    const stopwatch1Count = ref<number>(0);   // ã‚«ã‚¦ãƒ³ãƒˆã®åˆæœŸå€¤
    watch(stopwatch1Count, (newCount) => {
        // ã‚«ã‚¦ãƒ³ãƒˆãŒå¤‰ã‚ã£ãŸã‚‰ã€ä½•ã‹å‡¦ç†ã‚’ã—ãŸã„ã€‚

        // --------------------------------------------------------
        // - ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒã€€ï¼ã€€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« -
        // --------------------------------------------------------

        switch (appGameScheduleStep.value) {
            case 0:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰1ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 1 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 5;
                    star1StartRanks.value = 3;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;                    
                }
                break;
            case 1:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰3ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 3 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 2:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰4ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 4 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 9;
                    star1StartRanks.value = 9;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 3:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰6ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 6 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 4:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰8ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 8 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 0;
                    star1StartRanks.value = 8;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 5:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰10ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 10 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 6:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰14ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 14 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 12;
                    star1StartRanks.value = 5;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 7:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰15ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 15 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 8:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰19ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 19 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 3;
                    star1StartRanks.value = 3;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 9:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰21ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 21 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 10:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰27ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 27 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 6;
                    star1StartRanks.value = 11;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 11:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰29ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 29 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 12:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰33ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 33 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 4;
                    star1StartRanks.value = 6;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 13:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰36ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 36 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 14:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰39ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 39 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 5;
                    star1StartRanks.value = 0;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 15:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰41ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 41 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 16:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰45ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 45 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 6;
                    star1StartRanks.value = 7;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 17:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰48ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 48 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 18:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰51ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 51 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 7;
                    star1StartRanks.value = 3;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 19:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰54ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 54 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 20:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰57ç§’å¾Œã€æ˜Ÿè¡¨ç¤º
                if (newCount >= 57 * commonSeconds) {
                    star1StartTime.value = newCount;
                    star1StartFiles.value = 8;
                    star1StartRanks.value = 9;
                    star1Visibility.value = 'visible';
                    appGameScheduleStep.value += 1;
                }
                break;
            case 21:
                // ã‚²ãƒ¼ãƒ é–‹å§‹ã‹ã‚‰60ç§’å¾Œã€æ˜Ÿéè¡¨ç¤º
                if (newCount >= 59 * commonSeconds) {
                    star1Visibility.value = 'hidden';
                    appGameScheduleStep.value += 1;
                }
                break;
        }

        if (newCount >= appGameMaxCount.value) {
            // ã‚²ãƒ¼ãƒ åœæ­¢
            stopwatch1Ref.value?.timerStop();  // ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¹ãƒˆãƒƒãƒ—
        }
    });

    // ++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€ç›¤ +
    // ++++++++++++++++++++++++

    const board1SquareWidth = ref<number>(32);  // ãƒã‚¹ã®æ¨ªå¹…ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰
    const board1SquareHeight = ref<number>(32); // ãƒã‚¹ã®ç¸¦å¹…ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ï¼‰
    const board1Files = ref<number>(16);        // ç›¤ãŒæ¨ªã«ä½•ãƒã‚¹ã‹
    const board1Ranks = ref<number>(12);        // ç›¤ãŒç¸¦ã«ä½•ãƒã‚¹ã‹
    const board1Area = computed(()=>{           // ç›¤ã®ãƒã‚¹æ•°
        return board1Files.value * board1Ranks.value;
    });

    // ++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€æ˜Ÿ +
    // ++++++++++++++++++++++++

    const star1StartFiles = ref<number>(0);      // ç›¤ãŒæ¨ªã«ä½•ã‚»ãƒ«ã‹
    const star1StartRanks = ref<number>(0);      // æ˜Ÿã®å‡ºç¾ä½ç½®ã€‚ç›¤ã®ä¸Šã‹ã‚‰ä½•ã‚»ãƒ«ã‹
    const star1StartTime = ref<number>(0);      // æ˜Ÿã®å‡ºç¾countæ™‚é–“
    const star1Visibility = ref<'hidden' | 'visible'>('hidden');    // æ˜Ÿã®è¡¨ç¤ºï¼éè¡¨ç¤º

    const star1Files = computed(()=>{
        return star1StartFiles.value + Math.floor((stopwatch1Count.value - star1StartTime.value) / 20);
    });
    const star1Ranks = computed(()=>{
        return star1StartRanks.value;
    });
    const starStyle = computed(() => {
        return {
            visibility: star1Visibility.value,
            top: `${star1Ranks.value * board1SquareHeight.value}px`,
            left: `${star1Files.value * board1SquareWidth.value}px`,
            width: `${board1SquareWidth.value}px`,
            height: `${board1SquareHeight.value}px`,
        };
    });

    // ++++++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€è‡ªæ©Ÿï¼‘ +
    // ++++++++++++++++++++++++++++
    //
    // ã‚«ãƒ¡ãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ã€‚ç‚¹ç·šã®æ ã€‚
    //

    const player1Left = ref<number>(6 * board1SquareWidth.value);     // ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã®Xåº§æ¨™
    const player1Top = ref<number>(4 * board1SquareHeight.value);     // ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã®Yåº§æ¨™
    const player1FileNum = ref<number>(4);                            // ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã®åˆ—æ•°
    const player1RankNum = ref<number>(3);                            // ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã®è¡Œæ•°
    const player1Speed = ref<number>(4);                              // ç§»å‹•é€Ÿåº¦
    const player1Input = <Record<string, boolean>>{                     // å…¥åŠ›
        // ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †
        ArrowDown: false, ArrowLeft: false, ArrowUp: false, ArrowRight: false, Enter: false,
    };
    const player1AnimationWalkingFrames = 8;                        // æ­©è¡Œãƒ•ãƒ¬ãƒ¼ãƒ æ•°
    const player1MotionWait = ref<number>(0);   // æ’ä»–çš„ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“ã€‚
    const player1Motion = ref<Record<string, number>>({             // å…¥åŠ›
        xAxis: 0,   // è² ãªã‚‰å·¦ã€æ­£ãªã‚‰å³
        yAxis: 0,   // è² ãªã‚‰ä¸Šã€æ­£ãªã‚‰ä¸‹
    });
    const player1ReloadTime = ref<number>(0);                       // 0 ã«ãªã‚‹ã¾ã§ã€å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ãªã„
    const playerStyle = computed(() => {
        return {
            top: `${player1Top.value}px`,
            left: `${player1Left.value}px`,
            width: `${player1FileNum.value * board1SquareWidth.value}px`,
            height: `${player1RankNum.value * board1SquareHeight.value}px`,
            border: `dashed 4px ${player1ReloadTime.value > 0 ? '#d85050' : '#f0f0f0'}`, // ãƒªãƒ­ãƒ¼ãƒ‰ä¸­ã¯èµ¤ã„æ 
        };
    });

    // ++++++++++++++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€ãƒªãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ‘ã‚¤ +
    // ++++++++++++++++++++++++++++++++++++
    //
    // å†™çœŸã‚’æ’®ã£ãŸæ™‚ã«ã‚«ãƒ¡ãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ã®ä¸­å¿ƒã§å›ã£ã¦ã‚‹ã‚„ã¤ã€‚
    //

    const reloadPie1Frames = <
        Record<number, {top: number, left: number}>
    >{
        0: {top: 0 * board1SquareHeight.value, left: 0 * board1SquareWidth.value},
        1: {top: 0 * board1SquareHeight.value, left: 1 * board1SquareWidth.value},
        2: {top: 0 * board1SquareHeight.value, left: 2 * board1SquareWidth.value},
        3: {top: 0 * board1SquareHeight.value, left: 3 * board1SquareWidth.value},
        4: {top: 1 * board1SquareHeight.value, left: 0 * board1SquareWidth.value},
        5: {top: 1 * board1SquareHeight.value, left: 1 * board1SquareWidth.value},
        6: {top: 1 * board1SquareHeight.value, left: 2 * board1SquareWidth.value},
        7: {top: 1 * board1SquareHeight.value, left: 3 * board1SquareWidth.value},
    };
    const reloadPie1Weight = 3 * commonSeconds;
    const reloadPie1Index = computed<number>(()=>{
        // ã‚¿ã‚¤ãƒ«ï¼‘æšå½“ãŸã‚Šã®æ™‚é–“ï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ï¼‰
        const frameNum = Object.keys(reloadPie1Frames).length;
        const unitTime = reloadPie1Weight / frameNum;
        let index = Math.floor(player1ReloadTime.value / unitTime);
        if (index >= frameNum) {
            index = frameNum - 1;
        }
        return (frameNum - 1) - index;    // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³
    });
    const reloadPie1TileLeft = computed<number>(()=>{
        return reloadPie1Frames[reloadPie1Index.value].left;
    });
    const reloadPie1TileTop = computed<number>(()=>{
        return reloadPie1Frames[reloadPie1Index.value].top;
    });
    const reloadPieStyle = computed(() => {
        return {
            visibility: player1ReloadTime.value > 0 ? 'visible' : 'hidden',
            top: `${player1Top.value + player1RankNum.value * board1SquareHeight.value / 2 - board1SquareHeight.value / 2}px`,
            left: `${player1Left.value + player1FileNum.value * board1SquareWidth.value / 2 - board1SquareWidth.value / 2}px`,
        };
    });


    // ##########
    // # é–‹å§‹æ™‚ #
    // ##########

    onMounted(() => {
        sfxLoad();
        gameInit();
        gameLoopStart();

        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã®è¨­å®š
        //
        //      window ã¯ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãªã®ã§ã€ãƒã‚¦ãƒ³ãƒˆå¾Œã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚
        //
        window.addEventListener('keydown', (e: KeyboardEvent) => {
            // ä¸Šä¸‹ã‚­ãƒ¼ã®å ´åˆ
            if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                // ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ä¸Šä¸‹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å‹•ä½œã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                e.preventDefault();
            }

            if (player1Input.hasOwnProperty(e.key)) {
                player1Input[e.key] = true;
            }
        });
        window.addEventListener('keyup', (e) => {
            if (player1Input.hasOwnProperty(e.key)) {
                player1Input[e.key] = false;
            }
        });
    });


    onUnmounted(()=>{
        // åŠ¹æœéŸ³ã®ãƒ¡ãƒ¢ãƒªè§£æ”¾ã‚’çœŸé¢ç›®ã«è¡Œã†å ´åˆ
        if (sfxDeniedAudio) {
            sfxDeniedAudio.pause();
            sfxDeniedAudio.src = '';
            sfxDeniedAudio.load(); // ãƒãƒƒãƒ•ã‚¡ã‚¯ãƒªã‚¢
            // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è§£é™¤ï¼ˆå¿…è¦ãªã‚‰ï¼‰
            // sfxDeniedAudio.removeEventListener('ended', handler);
        }

        if (sfxCameraShutterAudio) {
            sfxCameraShutterAudio.pause();
            sfxCameraShutterAudio.src = '';
            sfxCameraShutterAudio.load(); // ãƒãƒƒãƒ•ã‚¡ã‚¯ãƒªã‚¢
        }

        if (sfxMissAudio) {
            sfxMissAudio.pause();
            sfxMissAudio.src = '';
            sfxMissAudio.load(); // ãƒãƒƒãƒ•ã‚¡ã‚¯ãƒªã‚¢
        }
    });


    // ################
    // # ã‚µãƒ–ãƒ«ãƒ¼ãƒãƒ³ #
    // ################

    /**
     * ï¼»ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆï¼½ã¾ãŸã¯ï¼»ã‚²ãƒ¼ãƒ çµ‚äº†ï¼½ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã€‚ï¼ˆçŠ¶æ…‹ã«ã‚ˆã‚Šåˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ï¼‰
     */
    function onGameStartOrEndButtonPushed() : void {
        focusRemove();  // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å¤–ã™

        if(appGameIsPlaying.value) {
            // ã‚²ãƒ¼ãƒ ã‚’çµ‚äº†ã•ã›ã¾ã™
            gameInit();
            return;
        }

        stopwatch1Ref.value?.timerStart();  // ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆ

        appGameIsPlaying.value = !appGameIsPlaying.value;
    }


    /**
     * ï¼»ä¸€æ™‚åœæ­¢ï¼½ã¾ãŸã¯ï¼»å†é–‹ï¼½ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã€‚ï¼ˆçŠ¶æ…‹ã«ã‚ˆã‚Šåˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ï¼‰
     */
    function onGamePauseOrRestartButtonPushed() : void {
        focusRemove();  // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å¤–ã™

        if(appGameIsPause.value) {
            stopwatch1Ref.value?.timerStart();  // ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆ
        } else {
            stopwatch1Ref.value?.timerStop();  // ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¹ãƒˆãƒƒãƒ—
        }

        appGameIsPause.value = !appGameIsPause.value;
    }


    /**
     * ã‚²ãƒ¼ãƒ ã®åˆæœŸåŒ–
     */
    function gameInit() : void {
        stopwatch1Ref.value?.timerReset();  // ã‚¿ã‚¤ãƒãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ

        appGameScore.value = 0;
        appGameIsPlaying.value = false;
        appGameIsPause.value = false;
        appGameScheduleStep.value = 0;

        star1Visibility.value = 'hidden';
    }


    /**
     * ã‚²ãƒ¼ãƒ ã®ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—é–‹å§‹
     */
    function gameLoopStart() : void {
        const update = () => {
            // ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ã‚¿ã‚¤ãƒãƒ¼
            player1MotionWait.value -= 1;

            if (player1ReloadTime.value > 0) {
                // ãƒªãƒ­ãƒ¼ãƒ‰ä¸­
                player1ReloadTime.value -= 1;
            }

            if (player1MotionWait.value==0) {
                player1Motion.value["xAxis"] = 0;    // ã‚¯ãƒªã‚¢ãƒ¼
                player1Motion.value["yAxis"] = 0;
            }
            
            // ++++++++++++++++++++++++++++++
            // + ã‚­ãƒ¼å…¥åŠ›ã‚’ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã«å¤‰æ› +
            // ++++++++++++++++++++++++++++++
            if (player1MotionWait.value<=0) {   // ã‚¦ã‚§ã‚¤ãƒˆãŒç„¡ã‘ã‚Œã°ã€å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã‚‹ã€‚

                if (player1Input.Enter) {
                    cameraShot();   // æ’®å½±
                }

                if (player1Input.ArrowLeft) {
                    player1Motion.value["xAxis"] = commonSpriteMotionLeft; // å·¦
                }

                if (player1Input.ArrowRight) {
                    player1Motion.value["xAxis"] = commonSpriteMotionRight;  // å³
                }

                if (player1Input.ArrowUp) {
                    player1Motion.value["yAxis"] = commonSpriteMotionUp;   // ä¸Š
                }

                if (player1Input.ArrowDown) {
                    player1Motion.value["yAxis"] = commonSpriteMotionDown;   // ä¸‹
                }

                if (player1Motion.value["xAxis"]!=0 || player1Motion.value["yAxis"]!=0) {
                    player1MotionWait.value = player1AnimationWalkingFrames;
                }
            }

            // ç§»å‹•å‡¦ç†
            // æ–œã‚æ–¹å‘ã®å ´åˆã€ä¸Šä¸‹ã‚’å„ªå…ˆã™ã‚‹ã€‚
            if (player1Motion.value["xAxis"]==1) {   // å³
                if (player1Left.value < (board1Files.value - player1FileNum.value) * board1SquareWidth.value) {    // å¢ƒç•Œãƒã‚§ãƒƒã‚¯
                    player1Left.value += player1Speed.value;
                }
            } else if (player1Motion.value["xAxis"]==-1) {  // å·¦
                if (0 < player1Left.value) {    // å¢ƒç•Œãƒã‚§ãƒƒã‚¯
                    player1Left.value -= player1Speed.value;
                }
            }

            if (player1Motion.value["yAxis"]==-1) {  // ä¸Š
                if (0 < player1Top.value) {    // å¢ƒç•Œãƒã‚§ãƒƒã‚¯
                    player1Top.value -= player1Speed.value;
                }
            } else if (player1Motion.value["yAxis"]==1) {   // ä¸‹
                if (player1Top.value < (board1Ranks.value - player1RankNum.value) * board1SquareHeight.value) {    // å¢ƒç•Œãƒã‚§ãƒƒã‚¯
                    player1Top.value += player1Speed.value;
                }
            }

            // æ¬¡ã®ãƒ•ãƒ¬ãƒ¼ãƒ 
            requestAnimationFrame(update);
        };

        // åˆå›å‘¼ã³å‡ºã—
        requestAnimationFrame(update);
    }


    /**
     * ã‚«ãƒ¡ãƒ©ã‚·ãƒ§ãƒƒãƒˆå‡¦ç†
     */
    function cameraShot() : void {

        if (player1ReloadTime.value > 0) {
            // ãƒªãƒ­ãƒ¼ãƒ‰ä¸­
            if (!sfxDeniedIsPlaying) {
                // ãƒ–ã‚¶ãƒ¼éŸ³ãŒåœæ­¢ä¸­ãªã‚‰é³´ã‚‰ã™
                sfxDeniedAudio.play();
            }

            // ãƒªãƒ­ãƒ¼ãƒ‰ä¸­ã¯ä½•ã‚‚èµ·ã“ã‚Šã¾ã›ã‚“ã€‚
            return;
        }

        // ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ã®ä½ç½®ã¨ã‚µã‚¤ã‚º
        const playerLeftFiles = player1Left.value / board1SquareWidth.value;
        const playerTopRanks = player1Top.value / board1SquareHeight.value;
        const playerRightEndFiles = playerLeftFiles + player1FileNum.value;
        const playerBottomEndRanks = playerTopRanks + player1RankNum.value;

        // ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ã®æ å†…ã«æ˜Ÿã‚’å«ã‚€ã‹ï¼Ÿ
        if (
            playerLeftFiles <= star1Files.value && star1Files.value <= playerRightEndFiles &&
            playerTopRanks <= star1Ranks.value && star1Ranks.value <= playerBottomEndRanks) {
            // æ˜Ÿã‚’å«ã‚“ã ã€‚
            niceShot();

        // æ˜Ÿã‚’å«ã¾ãªã„
        } else {
            if (!sfxMissIsPlaying) {
                // ãƒŸã‚¹éŸ³ãŒåœæ­¢ä¸­ãªã‚‰é³´ã‚‰ã™
                sfxMissAudio.play();
            }
        }

        player1ReloadTime.value = reloadPie1Weight;  // ãƒªãƒ­ãƒ¼ãƒ‰æ™‚é–“ã‚’è¨­å®š
    }


    /**
     * ã‚«ãƒ¡ãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ã®ä¸­ã«æ˜Ÿã‚’åã‚ã¦æ’®ã£ãŸã¨ãã€‚
     */
    function niceShot() : void {
        if (!sfxCameraShutterIsPlaying) {
            // ã‚«ãƒ¡ãƒ©ã®ã‚·ãƒ£ãƒƒã‚¿ãƒ¼éŸ³ãŒåœæ­¢ä¸­ãªã‚‰é³´ã‚‰ã™
            sfxCameraShutterAudio.play();
        }

        appGameScore.value += 100;
    }


    /**
     * ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å¤–ã™ã®ãŒä¸Šæ‰‹ãã„ã‹ãªã„ãŸã‚ã€ï¼»ä½•ã‚‚ã—ãªã„ãƒœã‚¿ãƒ³ï¼½ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’åˆã‚ã›ã¾ã™ã€‚
     */
    function focusRemove() : void {
        if (noopButton.value) {
            noopButton.value.$el.focus();    // $el ã¯ã€<v-btn> è¦ç´ ã®ä¸­ã® <button> è¦ç´ ã€‚
        }
    }


    /**
     * å·¦ã€‚
     */
    function onLeftButtonPressed() : void {
        player1Input.ArrowLeft = true;
    }


    function onLeftButtonReleased() : void {
        player1Input.ArrowLeft = false;
    }


    /**
     * ä¸Šã€‚
     */
    function onUpButtonPressed() : void {
        player1Input.ArrowUp = true;
    }


    function onUpButtonReleased() : void {
        player1Input.ArrowUp = false;
    }


    /**
     * å³ã€‚
     */
    function onRightButtonPressed() : void {
        player1Input.ArrowRight = true;
    }


    function onRightButtonReleased() : void {
        player1Input.ArrowRight = false;
    }


    /**
     * ä¸‹ã€‚
     */
    function onDownButtonPressed() : void {
        player1Input.ArrowDown = true;
    }


    function onDownButtonReleased() : void {
        player1Input.ArrowDown = false;
    }


    /**
     * ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ»ã‚­ãƒ¼ã€‚
     */
    function onEnterButtonPressed() : void {
        player1Input.Enter = true;
    }


    function onEnterButtonReleased() : void {
        player1Input.Enter = false;
    }

</script>

<style scoped>
    /** ã‚«ãƒ¡ãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒ€ãƒ¼ */
    div.player {
        position: relative; border:dashed 4px #f0f0f0;
    }
</style>
