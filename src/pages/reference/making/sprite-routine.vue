<template>
    <the-app-header/>
    <button-to-back-to-contents
        class="sec-0 mt-6"
        pagePath="../"
    />

    <h1>スプライト　＞　ルーチン　の章</h1>
    <section class="sec-1">
        <p>スプライトに一定の動きをさせるぜ（＾▽＾）</p>
        <br/>

        <stopwatch
            v-on:countUp="(countNum) => { count = countNum; }"/><br/>

        <p>ここに切り抜いたタイルを表示：</p>
        <div :style="`height: ${cellHeight}px`" style="position:relative;">
            <Tile
                :srcLeft="0"
                :srcTop="0"
                :srcWidth="cellWidth"
                :srcHeight="cellHeight"
                :tilemapUrl="'/img/making/sprite-objects-001.png'"
                style="position:absolute;"
                :style="o1Style" />
        </div>
        ：ここまで。<br/>
        <br/>

        元画像のタイルマップを表示：<br/>
        <v-img src="/img/making/sprite-objects-001.png" style="width:128px; height:128px; border: dashed 4px gray;"/>
        ：ここまで。
    </section>
    
    <br/>
    <h2>ソースコード</h2>
    <section class="sec-2">
        <source-link/>
    </section>

    <button-to-back-to-top class="sec-0 pt-6"/>
</template>

<script setup lang="ts">

    // ##############
    // # インポート #
    // ##############

   import { computed, ref } from 'vue';

    // ++++++++++++++++++++++++++++++++++
    // + インポート　＞　コンポーネント +
    // ++++++++++++++++++++++++++++++++++
    //
    // Tauri なら明示的にインポートを指定する必要がある。 Nuxt なら自動でインポートしてくれる場合がある。
    //

    import SourceLink from '../../../components/SourceLink.vue';
    import Stopwatch from '../../../components/Stopwatch.vue';
    import Tile from '../../../components/Tile.vue';

    // ++++++++++++++++++++++++++
    // + インポート　＞　ページ +
    // ++++++++++++++++++++++++++

    import ButtonToBackToContents from '@/components/ButtonToBackToContents.vue';
    import ButtonToBackToTop from '@/components/ButtonToBackToTop.vue';
    import TheAppHeader from '../../the-app-header.vue';


    // ##############
    // # 共有データ #
    // ##############

    // タイマー
    const count = ref<number>(0);   // カウントの初期値

    // タイル
    const cellWidth = 32;
    const cellHeight = 32;

    // オブジェクト１
    // 自機１
    const o1Left = ref<number>(0);      // スプライトのX座標
    const o1Top = ref<number>(0);       // スプライトのY座標
    const o1Speed = ref<number>(2);     // 移動速度
    const o1Style = computed(() => ({
        top: `${o1Top.value}px`,
        left: `${o1Left.value + (count.value * o1Speed.value) % 256}px`,
    }));

</script>
