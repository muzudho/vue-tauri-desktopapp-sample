<template>

    <!-- æ©Ÿèƒ½ -->
    <compatible-device ref="compatibleDevice1Ref"/>

    <!-- ä»¥é™ã€ãƒšãƒ¼ã‚¸ -->
    <the-app-header/>
    <button-to-back-to-contents
        class="sec-0 mt-6"
        pagePath="../"
    />

    <h1>JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­è¾¼ã‚‚ã†ãœï¼</h1>

    <button-to-go-to-top class="sec-1 pt-6"/>
    <h2>fetch() ã¨ useFetch()</h2>
    <section class="sec-2 pt-6">


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            JSONãƒ•ã‚¡ã‚¤ãƒ«ï¼‘ã¤èª­ã¿è¾¼ã‚€ã«ã‚‚ã‚„ã‚Šæ–¹ãŒã„ãã¤ã‹ã‚ã‚‹ã‚“ã§ã€ãã®é•ã„ã‚’ãƒ¡ãƒ¢ã—ã¦ãŠã“ã†ãœã€‚
        </talk-balloon>


        <talk-balloon
            :src="kifuwarabe2Src"
            :alt="kifuwarabe2Alt"
            :name="kifuwarabe2Name"
            :device="compatibleDevice1Ref?.device"
        >
            ğŸ‘‡ ã˜ã‚ƒã‚ã€ä»¥ä¸‹ã® JSON ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ã„ã¦ãŠããœã€‚
        </talk-balloon>


        <p>ğŸ“„ <a target="_blank" :href="jsonFilePath">public{{jsonFilePath}}</a>:</p>
        <pre class="coding-example mb-6">
{
    "#this-file": "JSONã®ã‚µãƒ³ãƒ—ãƒ«ã ãœï¼ˆï¼¾â–½ï¼¾ï¼‰"
}
        </pre>


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            ğŸ‘† ãã® JSON ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã‚³ãƒ¼ãƒ‰ã®ï¼‘ã¤ã«ã€<br/>
            ğŸ‘‡ æ¬¡ã®ã‚ˆã†ãªæ›¸ãæ–¹ãŒã‚ã‚‹ãã†ã ãœã€‚
        </talk-balloon>


        <pre class="coding-example mb-6">
&lt;template&gt;
    &lt;v-btn @click="loadJson1" class="mt-6 mb-6"&gt;JSONãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼&lt;/v-btn&gt;

    &lt;pre&gt;&#123;&#123; jsonStr &#125;&#125;&lt;/pre&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
    import { ref } from 'vue';

    const jsonStr = ref("èª­ã¿è¾¼ã¿ä¸­...");

    async function loadJson1() {
        try {
            const response = <span class="red-marker">await fetch</span>("/data/making/sample.json");   // publicãƒ•ã‚©ãƒ«ãƒ€ä¸‹ã®ãƒ‘ã‚¹
            if (!response.ok) throw new Error("Failed to fetch JSON");
            const data: any = await response.json();

            jsonStr.value = JSON.stringify(data, null, 4);

        } catch (error) {
            alert(`ERROR: sample.jsonãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼æ™‚ã€‚ ${error}`);
        }
    };
&lt;/script&gt;
        </pre>


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            ğŸ‘† ã“ã‚Œã‚’å®Ÿè¡Œã—ãŸçµæœã‚’è¦‹ã‚‹ã«ã¯ã€<br/>
            ğŸ‘‡ ä»¥ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã‚Œã ãœã€‚
        </talk-balloon>


        <v-btn @click="loadJson1" class="mt-6 mb-6">JSONãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼</v-btn>


        <pre class="coding-example mb-6">
{{ json1Str }}
        </pre>


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            ğŸ‘‡ ä»–ã«ã‚‚ã€Nuxt 3 ã‹ã‚‰æ¬¡ã®ã‚ˆã†ãªæ›¸ãæ–¹ã‚‚å¢—ãˆãŸãã†ã ãœã€‚
        </talk-balloon>


        <pre class="coding-example mb-6">
&lt;template&gt;
    &lt;pre&gt;&#123;&#123; jsonStr &#125;&#125;&lt;/pre&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
    import { ref } from 'vue';

    const jsonStr = ref("èª­ã¿è¾¼ã¿ä¸­...");

    const {
        data
    } = <span class="red-marker">await useFetch</span>&lt;any&gt;(
        jsonFilePath,   // public ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ‘ã‚¹
        {
            baseURL: '/',   // ï¼Ÿ
            transform: (jsonObj: unknown): any => {    // ã‚„ã‚ŠãŸã‘ã‚Œã°ã€ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›å‡¦ç†

                // JSON ãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆè¾æ›¸å‹ï¼‰ã‹ã©ã†ã‹ã®ãƒã‚§ãƒƒã‚¯
                if (jsonObj && typeof jsonObj === 'object') {
                    return jsonObj;
                }

                // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆè¾æ›¸å‹ï¼‰ã§ãªã‘ã‚Œã°ã€ç©ºè¾æ›¸ã‚’è¿”ã™
                return {};
            },
            default: () => [], // ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
        }
    );
    json2Str.value = data.value;
&lt;/script&gt;
        </pre>


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            ğŸ‘† ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€<br/>
            ğŸ‘‡ ä»¥ä¸‹ã®é€šã‚Šã€‚
        </talk-balloon>


        <pre class="coding-example mb-6">
{{ json2Str }}
        </pre>


        <talk-balloon
            :src="hiyoko2Src"
            :alt="hiyoko2Alt"
            :name="hiyoko2Name"
            :device="compatibleDevice1Ref?.device">
            å‰è€…ã® fetch() ã¨å¾Œè€…ã® useFetch() ã§ã¯ã€ä½•ãŒé•ã†ã®ï¼Ÿ
        </talk-balloon>


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            å‰è€…ã® fetch() ã¯ã€é™çš„ãƒšãƒ¼ã‚¸ã®åˆæœŸå€¤ã¨ã—ã¦ä½¿ãˆãªã„ã€‚<br/>
            ã ã‹ã‚‰ã€ãƒšãƒ¼ã‚¸ã®èª­è¾¼å®Œäº†ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚„ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ä½¿ã†ã“ã¨ã«ãªã‚‹ãœã€‚
        </talk-balloon>


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            å¾Œè€…ã® useFetch() ã¯ã€é™çš„ãƒšãƒ¼ã‚¸ã®åˆæœŸå€¤ã¨ã—ã¦ä½¿ãˆã‚‹ã€‚<br/>
            ã ã‹ã‚‰ã€ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã§ãã‚‹ã€‚
        </talk-balloon>


    </section>

    <button-to-go-to-top class="sec-1 pt-6"/>
    <h2>import()</h2>
    <section class="sec-2 pt-6">


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            ç¬¬ï¼“ã®æ–¹æ³•ã‚’èª¬æ˜ã™ã‚‹ã€‚<br/>
            ã¾ãšã€ä»¥ä¸‹ã®è¨­å®šã‚’ã—ã¦ãŠã„ã¦ãã‚Œã ãœã€‚<br/>
            <br/>
            ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®ç›´ä¸‹ã« public ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã¨ã€ nuxt.config.ts ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã¨ã™ã‚‹ãœã€‚
        </talk-balloon>


        <p class="mt-6">ğŸ“„ nuxt.config.tsï¼ˆæŠœç²‹ï¼‰:</p>
        <pre class="coding-example mb-6">
export default defineNuxtConfig({
    alias: {
        '#public': './public', // public/ ãƒ•ã‚©ãƒ«ãƒ€ã‚’ã‚¨ã‚¤ãƒªã‚¢ã‚¹
    },
})
        </pre>


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            ğŸ‘‡ ã‚“ã§ã€æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã€‚
        </talk-balloon>


        <pre class="coding-example mb-6">
&lt;template&gt;
    &lt;pre&gt;&#123;&#123; jsonStr &#125;&#125;&lt;/pre&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
    const jsonStr = ref("èª­ã¿è¾¼ã¿ä¸­...");

    try {
        // å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€ãŸã ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã¯åŸ‹è¾¼ã¿ã€‚
        const jsonObj = <span class="red-marker">await import</span>('#public/data/making/sample.json').then(module => module.default);
        json3Str.value = jsonObj;

    } catch (err: unknown) {
        const errorMessage = err instanceof Error ? err.message : String(err);
        json3Str.value = `ERROR: ${errorMessage}`;
    }
&lt;/script&gt;
        </pre>


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            ğŸ‘‡ ãã®çµæœã¯ä»¥ä¸‹ã®é€šã‚Šã ãœã€‚
        </talk-balloon>


        <pre class="coding-example mb-6">
{{ json3Str }}
        </pre>


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            ğŸ‘† await import() ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®ãƒ—ãƒªãƒ¬ãƒ³ãƒ€ãƒ¼ã§ã‚‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§ã‚‚ä½¿ãˆã‚‹ã€‚
        </talk-balloon>


        <talk-balloon
            :src="hiyoko2Src"
            :alt="hiyoko2Alt"
            :name="hiyoko2Name"
            :device="compatibleDevice1Ref?.device">
            ã˜ã‚ƒã‚å…¨éƒ¨ await import() ã§ã„ã„ã‚“ã˜ã‚ƒãªã„ã‹ãªã‚ï¼Ÿ
        </talk-balloon>


        <talk-balloon
            :src="oton2Src"
            :alt="oton2Alt"
            :name="oton2Name"
            :device="compatibleDevice1Ref?.device"
        >
            è‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§è¦‹ãˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã«é™ã‚‰ã‚Œã‚‹ã‘ã©ãªã€‚
        </talk-balloon>


    </section>

    <br/>
    <h2>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</h2>
    <section class="sec-2">
        <source-link/>
    </section>

    <button-to-go-to-top class="sec-0 pt-6"/>
</template>

<script setup lang="ts">

    // ##############
    // # ã‚¤ãƒ³ãƒãƒ¼ãƒˆ #
    // ##############

    import { ref } from 'vue';

    // ++++++++++++++++++++++++++++++++++
    // + ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€€ï¼ã€€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ +
    // ++++++++++++++++++++++++++++++++++
    //
    // Tauri ãªã‚‰æ˜ç¤ºçš„ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ Nuxt ãªã‚‰è‡ªå‹•ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãã‚Œã‚‹å ´åˆãŒã‚ã‚‹ã€‚
    //

    import CompatibleDevice from '@/components/CompatibleDevice.vue'
    import SourceLink from '@/components/SourceLink.vue';
    import TalkBalloon from '@/components/TalkBalloon.vue';

    // ++++++++++++++++++++++++++
    // + ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€€ï¼ã€€ãƒšãƒ¼ã‚¸ +
    // ++++++++++++++++++++++++++

    import ButtonToBackToContents from '@/components/ButtonToBackToContents.vue';
    import ButtonToGoToTop from '@/components/ButtonToGoToTop.vue';
    import TheAppHeader from '../../the-app-header.vue';


    // ##########
    // # ã‚³ãƒ¢ãƒ³ #
    // ##########
    //
    // ã‚ˆãä½¿ã†è¨­å®šã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã€‚ç‰¹ã«ä¸å¤‰ã®ã‚‚ã®ã€‚
    //

    import oton2Src from "@/assets/img/talk/202506__character__01-1951-kifuwarabeNoOton-o1o2o0.png";
    const oton2Alt = "ããµã‚ã‚‰ã¹ã®ãŠçˆ¶ã‚“ï¼’";
    const oton2Name = "ããµã‚ã‚‰ã¹ã®ãŠçˆ¶ã‚“";
    import kifuwarabe2Src from "@/assets/img/talk/202506__character__01-2013-kifuwarabe-o1o1o0.png";
    const kifuwarabe2Alt = "ããµã‚ã‚‰ã¹ï¼’";
    const kifuwarabe2Name = "ããµã‚ã‚‰ã¹";
    import hiyoko2Src from "@/assets/img/talk/202506__character__01-2025-hiyoko-o1o1o0.png";
    const hiyoko2Alt = "ã²ã‚ˆã“ï¼’";
    const hiyoko2Name = "ã²ã‚ˆã“";
    import kurokichi1Src from "@/assets/img/talk/202509__character__10--kurokichi.png";
    const kurokichi1Alt = "ã‚°ãƒ­ãƒƒã‚¯ã®é»’å‰ï¼‘";
    const kurokichi1Name = "ã‚°ãƒ­ãƒƒã‚¯ã®é»’å‰";

    // ++++++++++++++++++++++++++++
    // + ã‚³ãƒ¢ãƒ³ã€€ï¼ã€€å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ« +
    // ++++++++++++++++++++++++++++

    const jsonFilePath = "/data/making/sample.json";    // public/data/making/sample.json


    // ################
    // # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ #
    // ################

    // ++++++++++++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€è£…ç½®ã®äº’æ›æ€§ +
    // ++++++++++++++++++++++++++++++++++

    const compatibleDevice1Ref = ref<InstanceType<typeof CompatibleDevice> | null>(null);

    // ++++++++++++++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€JSONãƒ•ã‚¡ã‚¤ãƒ«ï¼‘ +
    // ++++++++++++++++++++++++++++++++++++

    const json1Str = ref("ä¸Šã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„...");

    async function loadJson1() {
        try {
            const response = await fetch(jsonFilePath);   // publicãƒ•ã‚©ãƒ«ãƒ€ã«ç½®ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚
            if (!response.ok) throw new Error("Failed to fetch JSON");
            const data: any = await response.json();

            json1Str.value = JSON.stringify(data, null, 4);

        } catch (error) {
            alert(`ERROR: sample.jsonãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼æ™‚ã€‚ ${error}`);
        }
    }

    // ++++++++++++++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€JSONãƒ•ã‚¡ã‚¤ãƒ«ï¼’ +
    // ++++++++++++++++++++++++++++++++++++

    const json2Str = ref("èª­ã¿è¾¼ã¿ä¸­...");

    // JSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ãŸã„ã€‚
    // ãªã‚“ã ã‹ã‚ˆãã‚ã‹ã‚‰ãªã„ãŒã€ useFetch ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ»ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã«ãã„ã‚‰ã—ã„ã€‚
    const {
        data
    } = await useFetch<any>(
        jsonFilePath,   // public ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ‘ã‚¹
        {
            baseURL: '/',   // ï¼Ÿ
            transform: (jsonObj: unknown): any => {    // ã‚„ã‚ŠãŸã‘ã‚Œã°ã€ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›å‡¦ç†

                // JSON ãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆè¾æ›¸å‹ï¼‰ã‹ã©ã†ã‹ã®ãƒã‚§ãƒƒã‚¯
                if (jsonObj && typeof jsonObj === 'object') {
                    return jsonObj;
                }

                // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆè¾æ›¸å‹ï¼‰ã§ãªã‘ã‚Œã°ã€ç©ºè¾æ›¸ã‚’è¿”ã™
                return {};
            },
            default: () => [], // ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
        }
    );
    json2Str.value = data.value;

    // ++++++++++++++++++++++++++++++++++++
    // + ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€€ï¼ã€€JSONãƒ•ã‚¡ã‚¤ãƒ«ï¼“ +
    // ++++++++++++++++++++++++++++++++++++

    const json3Str = ref("èª­ã¿è¾¼ã¿ä¸­...");

    try {
        // å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€ãŸã ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã¯åŸ‹è¾¼ã¿ã€‚
        const jsonObj = await import('#public/data/making/sample.json').then(module => module.default);

        json3Str.value = jsonObj;
    } catch (err: unknown) {
        const errorMessage = err instanceof Error ? err.message : String(err);
        json3Str.value = `ERROR: ${errorMessage}`;
    }

</script>

<style scoped>
    @import '@/styles/notebook.css';
</style>
